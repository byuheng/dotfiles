# ~/.config/yazi/yazi.toml

[mgr]
ratio = [1, 3, 4]
sort_by = "natural"
show_icons = true
linemode = "mtime"
scrolloff = 10

[preview]
image = true
backend = "sixel"
text = true
image_quality = 90
image_filter = "lanczos3"
max_width = 1280
max_height = 1024
image_delay = 0

[opener]
# The 'fish -c' wrapper for environment inheritance
office_view = [ { run = 'fish -c "zaread %s"', block = true, desc = "Zaread" } ]
office_edit = [ { run = 'fish -c "libreoffice %s"', orphan = true, desc = "LibreOffice" } ]
ebook_edit  = [ { run = 'fish -c "calibre %s"', orphan = true, desc = "Calibre" } ]
edit        = [ { run = 'nvim "%s"', block = true } ]
view        = [ { run = 'swayimg "%s"', orphan = true, desc = "Swayimg"} ]
pdf         = [ { run = 'zathura "%s"', orphan = true, desc = "Zathura" } ]
play        = [ { run = 'mpv "%s"', orphan = true } ]
open        = [ { run = 'xdg-open "%s"', desc = "Open" } ]

[open]
prepend_rules = [
    # --- Word / Text ---
    { url = "*.docx", use = [ "office_view", "office_edit" ] },
    { url = "*.doc",  use = [ "office_view", "office_edit" ] },
    { url = "*.docm", use = [ "office_view", "office_edit" ] },
    { url = "*.rtf",  use = [ "office_view", "office_edit" ] },
    
    # --- Excel / Spreadsheets ---
    { url = "*.xlsx", use = [ "office_view", "office_edit" ] },
    { url = "*.xls",  use = [ "office_view", "office_edit" ] },
    { url = "*.xlsm", use = [ "office_view", "office_edit" ] },
    { url = "*.csv",  use = [ "office_view", "office_edit" ] },
    
    # --- PowerPoint / Presentations ---
    { url = "*.pptx", use = [ "office_view", "office_edit" ] },
    { url = "*.ppt",  use = [ "office_view", "office_edit" ] },
    { url = "*.pptm", use = [ "office_view", "office_edit" ] },
    
    # --- LibreOffice Native ---
    { url = "*.odt",  use = [ "office_view", "office_edit" ] },
    { url = "*.ods",  use = [ "office_view", "office_edit" ] },
    { url = "*.odp",  use = [ "office_view", "office_edit" ] },
    { url = "*.odg",  use = [ "office_view", "office_edit" ] },
    
    # --- E-books ---
    { url = "*.epub", use = [ "office_view", "ebook_edit" ] },
    { url = "*.mobi", use = [ "office_view", "ebook_edit" ] },
    { url = "*.pdf",  use = "pdf" }
]

append_rules = [
    { mime = "image/*", use = "view" },
    { mime = "video/*", use = "play" },
    { mime = "audio/*", use = "play" },
    { url = "*.md",    use = "edit" },
    { mime = "text/*",  use = "edit" },
    { url = "*",       use = "open" }
]

[tasks]
micro_workers = 12
macro_workers = 8
bizarre_retry = 3
image_alloc = 536870912
image_bound = [0, 0]
suppress_preload = false
